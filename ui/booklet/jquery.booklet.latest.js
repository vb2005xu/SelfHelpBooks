(function(B){B.fn.booklet=function(E,D,K){var C,H,I,F,L,J,G;if(typeof E==="string"){L=new Array();B(this).each(function(){C=B(this).data("booklet");if(C){H=E;I=new Array();if(D){I.push(D)}if(K){I.push(K)}if(C[H]){F=C[H].apply(C,I);if(typeof F!=="undefined"||F){L.push(C[H].apply(C,I))}}else{B.error('Method "'+H+'" does not exist on jQuery.booklet.')}}else{B.error('jQuery.booklet has not been initialized. Method "'+E+'" cannot be called.')}});if(L.length==1){return L[0]}else{if(L.length>0){return L}else{return B(this)}}}else{if(typeof E==="number"){return B(this).each(function(){C=B(this).data("booklet");if(C){G=E;C.gotopage(G)}else{B.error("jQuery.booklet has not been initialized.")}})}else{if(typeof H==="object"||!H){return B(this).each(function(){J=B.extend({},B.fn.booklet.defaults,E);C=B(this).data("booklet");if(C){C.destroy()}C=new A(B(this),J);C.init();return this})}}}};function A(z,A5){var AT=z,A0=A5,AG=false,Bb=false,r=false,AF=false,Au=false,D=false,X={empty:'<div class="b-page-empty" title=""></div>',blank:'<div class="b-page-blank" title=""></div>',sF:'<div class="b-shadow-f"></div>',sB:'<div class="b-shadow-b"></div>'},AD={leftToRight:"LTR",rightToLeft:"RTL"},x={},An={},Am,W,Be,E=new Array(),k="",A7="/page/",P,G,H,F,L,Aw,M,n,Z,y,Az,AP,Bf,Y,S,AY,A9,Aj,Bd,Aq,AX,A1,Ax,V,v,AC,Ae,N,l,Ad,AB,s,AM,As,J,O,Ab,g,Av,AA,w,AS,AO,Ap,U,AW,A4,AI,u,AJ,Ak,Aa,f,e,Ag,Ba,p,AL,R,T,C,AR,Ac={create:"bookletcreate",start:"bookletstart",change:"bookletchange",add:"bookletadd",remove:"bookletremove"},Ay,Q=function(a,Bi,j){var h="",i="",Bh;if(a.attr("rel")){h=a.attr("rel")}if(a.attr("title")){i=a.attr("title")}if(a.hasClass("b-page-empty")){a.wrap('<div class="b-page"><div class="b-wrap"></div></div>')}else{if(j.closed&&j.covers&&(Bi==1||Bi==j.pageTotal-2)){a.wrap('<div class="b-page"><div class="b-wrap b-page-cover"></div></div>')}else{if(Bi%2!=0){a.wrap('<div class="b-page"><div class="b-wrap b-wrap-right"></div></div>')}else{a.wrap('<div class="b-page"><div class="b-wrap b-wrap-left"></div></div>')}}}Bh=a.parents(".b-page").addClass("b-page-"+Bi);if(j.pageNumbers&&!a.hasClass("b-page-empty")&&(!j.closed||(j.closed&&!j.covers)||(j.closed&&j.covers&&Bi!=1&&Bi!=j.pageTotal-2))){if(j.direction==AD.leftToRight){n++}a.parent().append('<div class="b-counter">'+n+"</div>");if(j.direction==AD.rightToLeft){n--}}return{index:Bi,contentNode:a[0],pageNode:Bh[0],chapter:h,title:i}},A6=function(){AT.find(".b-load").children().unwrap();AT.addClass("booklet");AT.data("booklet",this);M=AT.children().length;A0.currentIndex=0;AV();b();Ao();A3();Bg();AG=true;D=false;Ay={options:jQuery.extend({},A0),index:A0.currentIndex,pages:[E[A0.currentIndex].contentNode,E[A0.currentIndex+1].contentNode]};if(A0.create){AT.off(Ac.create+".booklet").on(Ac.create+".booklet",A0.create)}AT.trigger(Ac.create,Ay)},AZ=function(){D=false;b();c()},Ah=function(){AK()},m=function(){AK();o();AT.removeClass("booklet");AT.removeData("booklet");AG=false},AV=function(){E=new Array();if((AT.children().length%2)!=0){if(A0.closed&&A0.covers){AT.children().last().before(X.blank)}else{AT.children().last().after(X.blank)}}if(A0.closed){B(X.empty).attr({title:A0.closedFrontTitle||"",rel:A0.closedFrontChapter||""}).prependTo(AT);AT.children().last().attr({title:A0.closedBackTitle||"",rel:A0.closedBackChapter||""});AT.append(X.empty)}A0.pageTotal=AT.children().length;n=0;if(A0.direction==AD.rightToLeft){n=A0.pageTotal;if(A0.closed){n-=2}if(A0.covers){n-=2}B(AT.children().get().reverse()).each(function(){B(this).appendTo(AT)})}if(!AG){if(A0.direction==AD.leftToRight){A0.currentIndex=0}else{if(A0.direction==AD.rightToLeft){A0.currentIndex=A0.pageTotal-2}}if(!isNaN(A0.startingPage)&&A0.startingPage<=A0.pageTotal&&A0.startingPage>0){if((A0.startingPage%2)!=0){A0.startingPage--}A0.currentIndex=A0.startingPage}}AT.children().each(function(h){var a=new Q(B(this),h,A0);E.push(a)})},Ao=function(){AN();AU();c()},AN=function(){AT.find(".b-page").removeClass("b-pN b-p0 b-p1 b-p2 b-p3 b-p4").hide();if(A0.currentIndex-2>=0){AT.find(".b-page-"+(A0.currentIndex-2)).addClass("b-pN").show();AT.find(".b-page-"+(A0.currentIndex-1)).addClass("b-p0").show()}AT.find(".b-page-"+(A0.currentIndex)).addClass("b-p1").show();AT.find(".b-page-"+(A0.currentIndex+1)).addClass("b-p2").show();if(A0.currentIndex+3<=A0.pageTotal){AT.find(".b-page-"+(A0.currentIndex+2)).addClass("b-p3").show();AT.find(".b-page-"+(A0.currentIndex+3)).addClass("b-p4").show()}Z=AT.find(".b-pN");y=AT.find(".b-p0");Az=AT.find(".b-p1");AP=AT.find(".b-p2");Bf=AT.find(".b-p3");Y=AT.find(".b-p4");S=AT.find(".b-pN .b-wrap");AY=AT.find(".b-p0 .b-wrap");A9=AT.find(".b-p1 .b-wrap");Aj=AT.find(".b-p2 .b-wrap");Bd=AT.find(".b-p3 .b-wrap");Aq=AT.find(".b-p4 .b-wrap");AX=AT.find(".b-wrap");if(A0.shadows){AT.find(".b-shadow-f, .b-shadow-b").remove();A1=B(X.sF).css(x.sF).appendTo(Bf);Ax=B(X.sB).appendTo(y).css(x.sB)}},AU=function(){AT.find(".b-shadow-f, .b-shadow-b, .b-p0, .b-p3").css({"filter":"","zoom":""});AT.find(".b-page").removeAttr("style");AX.removeAttr("style");AX.css(x.wrap);AY.css(x.p0wrap);Az.css(x.p1);AP.css(x.p2);if(A0.closed&&A0.autoCenter&&A0.currentIndex>=A0.pageTotal-2){AP.hide()}Z.css(x.pN);y.css(x.p0);Bf.stop().css(x.p3);Y.css(x.p4);if(A0.closed&&A0.autoCenter&&A0.currentIndex==0){Z.css({"left":0});Az.css({"left":R});AP.css({"left":0});Bf.css({"left":AL});Y.css({"left":0})}if(A0.closed&&A0.autoCenter&&(A0.currentIndex==0||A0.currentIndex>=A0.pageTotal-2)){if(A0.overlays){Ae.width("100%")}AT.width(AL)}else{if(A0.overlays){Ae.width("50%")}AT.width(A0.width)}AT.find(".b-page").css({"filter":"","zoom":""})},o=function(){AT.find(".b-wrap").unwrap();AT.find(".b-wrap").children().unwrap();AT.find(".b-counter, .b-page-blank, .b-page-empty, .b-shadow-f, .b-shadow-b").remove();if(A0.direction==AD.rightToLeft){B(AT.children().get().reverse()).each(function(){B(this).appendTo(AT)})}},b=function(a){var h=false;if(a!=null&&typeof a!="undefined"){o();AK();D=false;A0=B.extend({},A0,a);h=true;AV()}if(!A0.width){A0.width=AT.width()}else{if(typeof A0.width=="string"&&A0.width.indexOf("px")!=-1){A0.width=A0.width.replace("px","")}else{if(typeof A0.width=="string"&&A0.width.indexOf("%")!=-1){e=true;Ag=A0.width;A0.width=(A0.width.replace("%","")/100)*parseFloat(AT.parent().css("width"))}}}if(!A0.height){A0.height=AT.height()}else{if(typeof A0.height=="string"&&A0.height.indexOf("px")!=-1){A0.height=A0.height.replace("px","")}else{if(typeof A0.height=="string"&&A0.height.indexOf("%")!=-1){Ba=true;p=A0.height;A0.height=(A0.height.replace("%","")/100)*parseFloat(AT.parent().css("height"))}}}AT.width(A0.width);AT.height(A0.height);AL=A0.width/2;R="-"+(AL)+"px";T=AL/2;C=A0.height;AR=A0.speed/2;if(A0.closed&&A0.autoCenter){if(A0.currentIndex==0){AT.width(AL)}else{if(A0.currentIndex>=A0.pageTotal-2){AT.width(AL)}}}if(A0.shadows){A0.shadowTopFwdWidth="-"+A0.shadowTopFwdWidth+"px";A0.shadowTopBackWidth="-"+A0.shadowTopBackWidth+"px"}A0.pageTotal=AT.children(".b-page").length;if(A0.name){document.title=A0.name}else{A0.name=document.title}AQ();if(AG){Ao()}if(A0.menu&&B(A0.menu).length>0){AA=B(A0.menu);if(!AA.hasClass("b-menu")){AA.addClass("b-menu")}if(A0.pageSelector&&AA.find(".b-selector-page").length==0){AO=B('<div class="b-selector b-selector-page"><span class="b-current">'+(A0.currentIndex+1)+" - "+(A0.currentIndex+2)+"</span></div>").appendTo(AA);Ap=B("<ul></ul>").appendTo(AO).empty().css("height","auto");for(G=0;G<A0.pageTotal;G+=2){H=G;U=(H+1)+"-"+(H+2);if(A0.closed){H--;if(G==0){U="1"}else{if(G==A0.pageTotal-2){U=A0.pageTotal-2}else{U=(H+1)+"-"+(H+2)}}if(A0.covers){H--;if(G==0){U="&nbsp;封面&nbsp;&nbsp;"}else{if(G==A0.pageTotal-2){U="&nbsp;封底&nbsp;&nbsp;"}else{U="第"+(H+1)+"-"+(H+2)+"页"}}}}if(G==0){AO.find(".b-current").text(U)}AW=E[G].title;if(AW==""){AW=E[G+1].title}if(A0.direction==AD.rightToLeft){AW=E[Math.abs(G-A0.pageTotal)-1].title;if(AW==""){AW=E[Math.abs(G-A0.pageTotal)-2].title}}A4=B('<li><a href="#'+A7+(G+1)+'" id="selector-page-'+G+'"><span class="b-text">'+AW+'</span><span class="b-num">'+U+"</span></a></li>").appendTo(Ap);if(!A0.hash){A4.find("a").on("click.booklet",function(){if(A0.direction==AD.rightToLeft){AO.find(".b-current").text(B(this).find(".b-num").text());t(Math.abs(parseInt(B(this).attr("id").replace("selector-page-",""))-A0.pageTotal)-2)}else{t(parseInt(B(this).attr("id").replace("selector-page-","")))}return false})}}AI=Ap.height();Ap.css({"height":0,"padding-bottom":0});AO.on("mouseenter.booklet",function(){Ap.stop().animate({height:AI,paddingBottom:10},500)}).on("mouseleave.booklet",function(){Ap.stop().animate({height:0,paddingBottom:0},500)})}else{if(!A0.pageSelector){AA.find(".b-selector-page").remove();AO=Ap=U=AW=A4=AI=null}}if(A0.chapterSelector&&AA.find(".b-selector-chapter").length==0){u=E[A0.currentIndex].chapter;if(u==""){u=E[A0.currentIndex+1].chapter}AJ=B('<div class="b-selector b-selector-chapter"><span class="b-current">'+u+"</span></div>").appendTo(AA);Ak=B("<ul></ul>").appendTo(AJ).empty().css("height","auto");for(G=0;G<A0.pageTotal;G+=1){if(E[G].chapter!=""&&typeof E[G].chapter!="undefined"){if(A0.direction==AD.rightToLeft){H=G;if(H%2!=0){H--}AJ.find(".b-current").text(E[G].chapter);Aa=B('<li><a href="#'+A7+(H+1)+'" id="selector-page-'+(H)+'"><span class="b-text">'+E[G].chapter+"</span></a></li>").prependTo(Ak)}else{Aa=B('<li><a href="#'+A7+(G+1)+'" id="selector-page-'+G+'"><span class="b-text">'+E[G].chapter+"</span></a></li>").appendTo(Ak)}if(!A0.hash){Aa.find("a").on("click.booklet",function(){var i;if(A0.direction==AD.rightToLeft){AJ.find(".b-current").text(B(this).find(".b-text").text());i=Math.abs(parseInt(B(this).attr("id").replace("selector-page-",""))-A0.pageTotal)-2}else{i=parseInt(B(this).attr("id").replace("selector-page-",""))}if(i%2!=0){i-=1}t(i);return false})}}}f=Ak.height();Ak.css({"height":0,"padding-bottom":0});AJ.on("mouseenter.booklet",function(){Ak.stop().animate({height:f,paddingBottom:10},500)}).on("mouseleave.booklet",function(){Ak.stop().animate({height:0,paddingBottom:0},500)})}else{if(!A0.chapterSelector){AA.find(".b-selector-chapter").remove();u=AJ=Ak=Aa=f=null}}}else{AA=null;if(A0.menu){B(A0.menu).removeClass("b-menu")}AT.find(".b-selector").remove()}AC=AT.find(".b-controls");if(AC.length==0){AC=B('<div class="b-controls"></div>').appendTo(AT)}if(A0.manual&&B.ui){A0.overlays=false}if(O){O.off("click.booklet")}if(A0.next&&B(A0.next).length>0){O=B(A0.next);O.on("click.booklet",function(i){i.preventDefault();AE()})}else{O=null}if(Ab){Ab.off("click.booklet")}if(A0.prev&&B(A0.prev).length>0){Ab=B(A0.prev);Ab.on("click.booklet",function(i){i.preventDefault();Bc()})}else{Ab=null}Ae=AT.find(".b-overlay");if(A0.overlays&&Ae.length==0){l=B('<div class="b-overlay b-overlay-prev b-prev" title="'+A0.previousControlTitle+'"></div>').appendTo(AC);N=B('<div class="b-overlay b-overlay-next b-next" title="'+A0.nextControlTitle+'"></div>').appendTo(AC);Ae=AT.find(".b-overlay");if(B.browser.msie){Ae.css({"background":"#fff","filter":"progid:DXImageTransform.Microsoft.Alpha(opacity=0) !important"})}}else{if(!A0.overlays){Ae.remove();Ae=null}}Ad=AT.find(".b-tab");if(A0.tabs&&Ad.length==0){s=B('<div class="b-tab b-tab-prev b-prev" title="'+A0.previousControlTitle+'">'+A0.previousControlText+"</div>").appendTo(AC);AB=B('<div class="b-tab b-tab-next b-next" title="'+A0.nextControlTitle+'">'+A0.nextControlText+"</div>").appendTo(AC);Ad=AT.find(".b-tab")}else{if(!A0.tabs){AT.css({"marginTop":0});Ad.remove();Ad=null}}if(A0.tabs&&Ad.length>0){if(A0.tabWidth){Ad.width(A0.tabWidth)}if(A0.tabHeight){Ad.height(A0.tabHeight)}Ad.css({"top":"-"+AB.outerHeight()+"px"});AT.css({"marginTop":AB.outerHeight()});if(A0.direction==AD.rightToLeft){AB.html(A0.previousControlText).attr("title",A0.previousControlTitle);s.html(A0.nextControlText).attr("title",A0.nextControlTitle)}}AM=AT.find(".b-arrow");if(A0.arrows&&AM.length==0){J=B('<div class="b-arrow b-arrow-prev b-prev" title="'+A0.previousControlTitle+'"><div>'+A0.previousControlText+"</div></div>").appendTo(AC);As=B('<div class="b-arrow b-arrow-next b-next" title="'+A0.nextControlTitle+'"><div>'+A0.nextControlText+"</div></div>").appendTo(AC);AM=AT.find(".b-arrow");if(A0.direction==AD.rightToLeft){As.html("<div>"+A0.previousControlText+"</div>").attr("title",A0.previousControlTitle);J.html("<div>"+A0.nextControlText+"</div>").attr("title",A0.nextControlTitle)}}else{if(!A0.arrows){AM.remove();AM=null}}g=AC.find(".b-next");Av=AC.find(".b-prev");g.off(".booklet");Av.off(".booklet");g.on("click.booklet",function(i){i.preventDefault();AE()});Av.on("click.booklet",function(i){i.preventDefault();Bc()});if(A0.overlays&&A0.hovers){g.on("mouseover.booklet",function(){Af(true)}).on("mouseout.booklet",function(){A8(true)});Av.on("mouseover.booklet",function(){Af(false)}).on("mouseout.booklet",function(){A8(false)})}if(A0.arrows){if(A0.arrowsHide){if(B.support.opacity){g.on("mouseover.booklet",function(){As.find("div").stop().fadeTo("fast",1)}).on("mouseout.booklet",function(){As.find("div").stop().fadeTo("fast",0)});Av.on("mouseover.booklet",function(){J.find("div").stop().fadeTo("fast",1)}).on("mouseout.booklet",function(){J.find("div").stop().fadeTo("fast",0)})}else{g.on("mouseover.booklet",function(){As.find("div").show()}).on("mouseout.booklet",function(){As.find("div").hide()});Av.on("mouseover.booklet",function(){J.find("div").show()}).on("mouseout.booklet",function(){J.find("div").hide()})}}else{As.find("div").show();J.find("div").show()}}B(document).on("keyup.booklet",function(i){if(i.keyCode==37&&A0.keyboard&&!D){Bc()}else{if(i.keyCode==39&&A0.keyboard&&!D){AE()}}});clearInterval(F);F=null;if(A0.hash){d();clearInterval(F);F=setInterval(function(){At()},250)}B(window).on("resize.booklet",function(){if((e||Ba)&&!D){Ai()}});if(A0.auto&&A0.delay){clearInterval(L);L=setInterval(function(){if(A0.direction==AD.leftToRight){AE()}else{Bc()}},A0.delay);r=true;if(A0.pause&&B(A0.pause).length>0){w=B(A0.pause);w.off("click.booklet").on("click.booklet",function(i){i.preventDefault();if(r){clearInterval(L);r=false}})}if(A0.play&&B(A0.play).length>0){AS=B(A0.play);AS.off("click.booklet").on("click.booklet",function(i){i.preventDefault();if(!r){clearInterval(L);L=setInterval(function(){if(A0.direction==AD.leftToRight){AE()}else{Bc()}},A0.delay);r=true}})}}else{clearInterval(L);L=null;if(A0.pause&&B(A0.pause).length>0){B(A0.pause).off("click.booklet")}w=null;if(A0.play&&B(A0.play).length>0){B(A0.play).off("click.booklet")}AS=null;r=false}if(h){Ao();A3();Bg()}},AQ=function(){x={wrap:{left:0,width:AL-(A0.pagePadding*2)-(A0.pageBorder*2),height:C-(A0.pagePadding*2)-(A0.pageBorder*2),padding:A0.pagePadding},p0wrap:{right:0,left:"auto"},p1:{left:0,width:AL,height:C},p2:{left:AL,width:AL,opacity:1,height:C},pN:{left:0,width:AL,height:C},p0:{left:0,width:0,height:C},p3:{left:AL*2,width:0,height:C,paddingLeft:0},p4:{left:AL,width:AL,height:C},sF:{right:0,width:AL,height:C},sB:{left:0,width:AL,height:C}};Am=10;W=A0.hoverWidth+Am;Be=(A0.hoverWidth/2)+Am;An={hover:{speed:A0.hoverSpeed,size:A0.hoverWidth,p2:{width:AL-Be},p3:{left:A0.width-W,width:Be},p3closed:{left:AL-A0.hoverWidth,width:Be},p3wrap:{left:Am},p2end:{width:AL},p2closedEnd:{width:AL,left:0},p3end:{left:A0.width,width:0},p3closedEnd:{left:AL,width:0},p3wrapEnd:{left:10},p1:{left:Be,width:AL-Be},p1wrap:{left:"-"+Be+"px"},p0:{left:Be,width:Be},p0wrap:{right:Am},p1end:{left:0,width:AL},p1wrapEnd:{left:0},p0end:{left:0,width:0},p0wrapEnd:{right:0}},p2:{width:0},p2closed:{width:0,left:AL},p4closed:{left:AL},p3in:{left:T,width:T,paddingLeft:A0.shadowBtmWidth},p3inDrag:{left:AL/4,width:AL*0.75,paddingLeft:A0.shadowBtmWidth},p3out:{left:0,width:AL,paddingLeft:0},p3wrapIn:{left:A0.shadowBtmWidth},p3wrapOut:{left:0},p1:{left:AL,width:0},p1wrap:{left:R},p0:{left:AL,width:AL},p0in:{left:T,width:T},p0out:{left:AL,width:AL},p0outClosed:{left:0,width:AL},p2back:{left:0},p0wrapDrag:{right:0},p0wrapIn:{right:A0.shadowBtmWidth},p0wrapOut:{right:0}}},Ai=function(){if(e){A0.width=(Ag.replace("%","")/100)*parseFloat(AT.parent().css("width"));AT.width(A0.width);AL=A0.width/2;R="-"+(AL)+"px";T=AL/2}if(Ba){A0.height=(p.replace("%","")/100)*parseFloat(AT.parent().css("height"));AT.height(A0.height);C=A0.height}AQ();AU()},A3=function(){if(A0.overlays||A0.tabs||A0.arrows){if(B.support.opacity){if(A0.currentIndex>=2&&A0.currentIndex!=0){Av.fadeIn("fast").css("cursor",A0.cursor)}else{Av.fadeOut("fast").css("cursor","default")}if(A0.currentIndex<A0.pageTotal-2){g.fadeIn("fast").css("cursor",A0.cursor)}else{g.fadeOut("fast").css("cursor","default")}}else{if(A0.currentIndex>=2&&A0.currentIndex!=0){Av.show().css("cursor",A0.cursor)}else{Av.hide().css("cursor","default")}if(A0.currentIndex<A0.pageTotal-2){g.show().css("cursor",A0.cursor)}else{g.hide().css("cursor","default")}}}},Bg=function(){if(A0.pageSelector){var a="";if(A0.direction==AD.rightToLeft){a=(Math.abs(A0.currentIndex-A0.pageTotal)-1)+" - "+((Math.abs(A0.currentIndex-A0.pageTotal)));if(A0.closed){if(A0.currentIndex==A0.pageTotal-2){a="1"}else{if(A0.currentIndex==0){a=A0.pageTotal-2}else{a=(Math.abs(A0.currentIndex-A0.pageTotal)-2)+" - "+((Math.abs(A0.currentIndex-A0.pageTotal)-1))}}if(A0.covers){if(A0.currentIndex==A0.pageTotal-2){a=""}else{if(A0.currentIndex==0){a=""}else{a=(Math.abs(A0.currentIndex-A0.pageTotal)-3)+" - "+((Math.abs(A0.currentIndex-A0.pageTotal)-2))}}}}}else{a=(A0.currentIndex+1)+" - "+(A0.currentIndex+2);if(A0.closed){if(A0.currentIndex==0){a="1"}else{if(A0.currentIndex==A0.pageTotal-2){a=A0.pageTotal-2}else{a=(A0.currentIndex)+"-"+(A0.currentIndex+1)}}if(A0.covers){if(A0.currentIndex==0){a="封面"}else{if(A0.currentIndex==A0.pageTotal-2){a="封底"}else{a="第"+(A0.currentIndex-1)+"-"+(A0.currentIndex)+"页"}}}}}B(A0.menu+" .b-selector-page .b-current").text(a)}if(A0.chapterSelector){if(E[A0.currentIndex].chapter!=""){B(A0.menu+" .b-selector-chapter .b-current").text(E[A0.currentIndex].chapter)}else{if(E[A0.currentIndex+1].chapter!=""){B(A0.menu+" .b-selector-chapter .b-current").text(E[A0.currentIndex+1].chapter)}}if(A0.direction==AD.rightToLeft&&E[A0.currentIndex+1].chapter!=""){B(A0.menu+" .b-selector-chapter .b-current").text(E[A0.currentIndex+1].chapter)}else{if(E[A0.currentIndex]!=""){B(A0.menu+" .b-selector-chapter .b-current").text(E[A0.currentIndex].chapter)}}}},c=function(){var h,i,Bi,j,Bl,Bk,Bn,Bm,a,Bh,Bj;AF=Au=V=v=false;if(AT.find(".b-page").draggable()){AT.find(".b-page").draggable("destroy").removeClass("b-grab b-grabbing")}if(A0.manual&&B.ui){Bf.draggable({axis:"x",containment:[AT.offset().left,0,AP.offset().left+AL-W,C],drag:function(Bp,Bo){V=true;Bf.removeClass("b-grab").addClass("b-grabbing");h=Bo.originalPosition.left;i=Bo.position.left;Bi=h-i;j=Bi/h;Bl=j<0.5?j:(1-j);Bk=(Bl*A0.shadowBtmWidth*2)+Am;Bk=Bi/h>=0.5?Bk-=Am:Bk;if(A0.shadows){A1.css({"right":"-"+(A0.shadowTopFwdWidth*Bl*2)+"px"});if(B.support.opacity){A1.css({"opacity":Bl*2})}else{A1.css({"right":"auto","left":0.1*Bf.width()})}}Bn=Be+Bi/2;Bn=Bn>AL?AL:Bn;Bm=AL-Bn;if(A0.closed&&A0.autoCenter){if(A0.currentIndex==0){a=0.5+0.5*j;Bn=Be+(Be*j)+Bi;Bn=Bn>AL?AL:Bn;Bm=AL-Bn;AP.css({left:AL*j});Y.css({left:AL*j});AT.width(A0.width*a)}else{if(A0.currentIndex==A0.pageTotal-4){a=(1-j)+0.5*j;Bm=AL-Bn;Y.hide();AT.width(A0.width*a)}else{AT.width(A0.width)}}}Bf.width(Bn);Bd.css({left:Bk});AP.width(Bm)},stop:function(Bp,Bo){A8(false);if(j>A0.hoverThreshold){if(A0.shadows&&!B.support.opacity){A1.css({"left":"auto",opacity:0})}AE();Bf.removeClass("b-grab b-grabbing")}else{V=false;Bf.removeClass("b-grabbing").addClass("b-grab");A1.animate({left:"auto",opacity:0},An.hover.speed,A0.easing).css(x.sF);if(A0.closed&&A0.autoCenter){if(A0.currentIndex==0){AP.animate({left:0},An.hover.speed,A0.easing);Y.animate({left:0},An.hover.speed,A0.easing);AT.animate({width:A0.width*0.5},An.hover.speed,A0.easing)}else{AT.animate({width:A0.width},An.hover.speed,A0.easing)}}}}});y.draggable({axis:"x",containment:[AT.offset().left+Be,0,AT.offset().left+A0.width,C],drag:function(Bp,Bo){v=true;y.removeClass("b-grab").addClass("b-grabbing");h=Bo.originalPosition.left;i=Bo.position.left;Bi=i-h;j=Bi/(A0.width-h);if(A0.closed&&A0.autoCenter&&A0.currentIndex==2){j=Bi/(AL-h)}if(j>1){j=1}Bl=j<0.5?j:(1-j);Bk=(Bl*A0.shadowBtmWidth*2)+Am;Bk=Bi/h>=0.5?Bk-=Am:Bk;if(A0.shadows){if(B.support.opacity){Ax.css({"opacity":Bl*2})}else{Ax.css({"left":A0.shadowTopBackWidth*Bl*2})}}Bn=j*(AL-Be)+Be+Bk;Bh=Bn-Bk;Bj=-Bh;if(A0.closed&&A0.autoCenter){if(A0.currentIndex==2){a=(1-j)+0.5*j;Bh=(1-j)*Bh;Bj=-Bh-(A0.width-(A0.width*a));Z.hide();AP.css({left:AL*(1-j)});Y.css({left:AL*(1-j)});AT.width(A0.width*a)}else{if(A0.currentIndex==A0.pageTotal-2){a=0.5+0.5*j;AT.width(A0.width*a)}else{AT.width(A0.width)}}}Bo.position.left=Bh;y.css({width:Bn});AY.css({right:Bk});Az.css({left:Bh,width:AL-Bh});A9.css({left:Bj})},stop:function(Bp,Bo){A8(true);if(j>A0.hoverThreshold){Bc();y.removeClass("b-grab b-grabbing")}else{Ax.animate({opacity:0},An.hover.speed,A0.easing).css(x.sB);v=false;y.removeClass("b-grabbing").addClass("b-grab");if(A0.closed&&A0.autoCenter){if(A0.currentIndex==2){AP.animate({left:AL},An.hover.speed*2,A0.easing);Y.animate({left:AL},An.hover.speed*2,A0.easing);AT.animate({width:A0.width},An.hover.speed*2,A0.easing)}else{if(A0.currentIndex==A0.pageTotal-2){AT.animate({width:A0.width*0.5},An.hover.speed,A0.easing)}}}}}});AT.find(".b-page").off("click.booklet");if(A0.hoverClick){AT.find(".b-pN, .b-p0").on("click.booklet",Bc).css({cursor:"pointer"});AT.find(".b-p3, .b-p4").on("click.booklet",AE).css({cursor:"pointer"})}AT.off("mousemove.booklet").on("mousemove.booklet",function(Bo){Bi=Bo.pageX-AT.offset().left;if(Bi<An.hover.size){Af(false)}else{if(Bi>AL-An.hover.size&&A0.currentIndex==0&&A0.autoCenter&&A0.closed){Af(true)}else{if(Bi>An.hover.size&&Bi<=A0.width-An.hover.size){A8(false);A8(true)}else{if(Bi>A0.width-An.hover.size){Af(true)}}}}}).off("mouseleave.booklet").on("mouseleave.booklet",function(){A8(false);A8(true)})}},d=function(){P=Al();if(!isNaN(P)&&P<=A0.pageTotal-1&&P>=0&&P!=""){if((P%2)!=0){P--}A0.currentIndex=P}else{AH(A0.currentIndex+1,A0)}k=P},At=function(){P=Al();if(!isNaN(P)&&P<=A0.pageTotal-1&&P>=0){if(P!=A0.currentIndex&&P.toString()!=k){if((P%2)!=0){P--}document.title=A0.name+A0.hashTitleText+(P+1);if(!Bb){t(P);k=P}}}},Al=function(){var a,h;a=window.location.hash.split("/");if(a.length>1){h=parseInt(a[2])-1;if(A0.direction==AD.rightToLeft){h=Math.abs(h+1-A0.pageTotal)}return h}else{return""}},AH=function(a,h){if(h.hash){if(h.direction==AD.rightToLeft){a=Math.abs(a-h.pageTotal)}window.location.hash=A7+a}},AK=function(){if(A0.menu){B(A0.menu).removeClass("b-menu");if(A0.pageSelector){AA.find(".b-selector-page").remove();AO=Ap=U=AW=A4=AI=null}if(A0.chapterSelector){AA.find(".b-selector-chapter").remove();u=AJ=Ak=Aa=f=null}}AA=null;if(O){O.off("click.booklet");O=null}if(Ab){Ab.off("click.booklet");Ab=null}if(g){g.off(".booklet");g=null}if(Av){Av.off(".booklet");Av=null}AT.find(".b-selector, .b-controls").remove();D=true;clearInterval(F);F=null;clearInterval(L);L=null;if(A0.pause&&B(A0.pause).length>0){B(A0.pause).off("click.booklet")}w=null;if(A0.play&&B(A0.play).length>0){B(A0.play).off("click.booklet")}AS=null;K()},K=function(){if(AT.find(".b-page").draggable()){AT.find(".b-page").draggable("destroy").removeClass("b-grab b-grabbing")}AT.off(".booklet")},A2=function(h,a){if(h=="start"){h=0}else{if(h=="end"){h=M}else{if(typeof h=="number"){if(h<0||h>M){return}}else{if(typeof h=="undefined"){return}}}}if(typeof a=="undefined"||a==""){return}o();AK();if(A0.closed&&A0.covers&&h==M){AT.children(":eq("+(h-1)+")").before(a)}else{if(A0.closed&&A0.covers&&h==0){AT.children(":eq("+h+")").after(a)}else{if(h==M){AT.children(":eq("+(h-1)+")").after(a)}else{AT.children(":eq("+h+")").before(a)}}}M=AT.children().length;Ay={options:jQuery.extend({},A0),index:h,page:AT.children(":eq("+h+")")[0]};if(A0.add){AT.off(Ac.add+".booklet").on(Ac.add+".booklet",A0.add)}AT.trigger(Ac.add,Ay);D=false;AV();b();Ao();A3();Bg()},q=function(h){if(h=="start"){h=0}else{if(h=="end"){h=M}else{if(typeof h=="number"){if(h<0||h>M){return}}else{if(typeof h=="undefined"){return}}}}if(AT.children(".b-page").length==2&&AT.find(".b-page-blank").length>0){return}o();AK();if(h>=A0.currentIndex){if(h>0&&(h%2)!=0){A0.currentIndex-=2}if(A0.currentIndex<0){A0.currentIndex=0}}var a;if(A0.closed&&A0.covers&&h==M){a=AT.children(":eq("+(h-1)+")").remove()}else{if(A0.closed&&A0.covers&&h==0){a=AT.children(":eq("+h+")").remove()}else{if(h==M){a=AT.children(":eq("+(h-1)+")").remove()}else{a=AT.children(":eq("+h+")").remove()}}}M=AT.children().length;Ay={options:jQuery.extend({},A0),index:h,page:a[0]};if(A0.remove){AT.off(Ac.remove+".booklet").on(Ac.remove+".booklet",A0.remove)}AT.trigger(Ac.remove,Ay);a=null;D=false;AV();Ao();b();A3();Bg()},AE=function(){if(!Bb){if(r&&A0.currentIndex+2>=A0.pageTotal){t(0)}else{t(A0.currentIndex+2)}}},Bc=function(){if(!Bb){if(r&&A0.currentIndex-2<0){t(A0.pageTotal-2)}else{t(A0.currentIndex-2)}}},t=function(h){var a;if(h>A0.currentIndex&&h<A0.pageTotal&&h>=0&&!Bb){Bb=true;Aw=h-A0.currentIndex;A0.currentIndex=h;A0.movingForward=true;Ay={options:jQuery.extend({},A0),index:h,pages:[E[h].contentNode,E[h+1].contentNode]};if(A0.start){AT.off(Ac.start+".booklet").on(Ac.start+".booklet",A0.start)}AT.trigger(Ac.start,Ay);Bg();if(h==A0.pageTotal-2){A3()}AH(A0.currentIndex+1,A0);a=V===true?A0.speed*(Bf.width()/AL):AR;Ar(Aw,true,A1,a);if(A0.closed&&A0.autoCenter&&h-Aw==0){AP.stop().animate(An.p2closed,V===true?a:a*2,A0.easing);Y.stop().animate(An.p4closed,V===true?a:a*2,A0.easing)}else{AP.stop().animate(An.p2,a,V===true?A0.easeOut:A0.easeIn)}if(V){Bf.animate(An.p3out,a,A0.easeOut);Bd.animate(An.p3wrapOut,a,A0.easeOut,function(){I()})}else{Bf.stop().animate(An.p3in,a,A0.easeIn).animate(An.p3out,a,A0.easeOut);Bd.animate(An.p3wrapIn,a,A0.easeIn).animate(An.p3wrapOut,a,A0.easeOut,function(){I()})}}else{if(h<A0.currentIndex&&h<A0.pageTotal&&h>=0&&!Bb){Bb=true;Aw=A0.currentIndex-h;A0.currentIndex=h;A0.movingForward=false;Ay={options:jQuery.extend({},A0),index:h,pages:[E[h].contentNode,E[h+1].contentNode]};if(A0.start){AT.off(Ac.start+".booklet").on(Ac.start+".booklet",A0.start)}AT.trigger(Ac.start,Ay);Bg();if(h==0){A3()}AH(A0.currentIndex+1,A0);a=v===true?A0.speed*(y.width()/AL):AR;Ar(Aw,false,Ax,a);if(v){Az.animate(An.p1,a,A0.easeOut);A9.animate(An.p1wrap,a,A0.easeOut);if(A0.closed&&A0.autoCenter&&A0.currentIndex==0){y.animate(An.p0outClosed,a,A0.easeOut);AP.stop().animate(An.p2back,a,A0.easeOut)}else{y.animate(An.p0,a,A0.easeOut)}AY.animate(An.p0wrapDrag,a,A0.easeOut,function(){I()})}else{Az.animate(An.p1,a*2,A0.easing);A9.animate(An.p1wrap,a*2,A0.easing);if(A0.closed&&A0.autoCenter&&A0.currentIndex==0){y.animate(An.p0in,a,A0.easeIn).animate(An.p0outClosed,a,A0.easeOut);AP.stop().animate(An.p2back,a*2,A0.easing)}else{y.animate(An.p0in,a,A0.easeIn).animate(An.p0out,a,A0.easeOut)}AY.animate(An.p0wrapIn,a,A0.easeIn).animate(An.p0wrapOut,a,A0.easeOut,function(){I()})}}}},Af=function(a){if((A0.hovers&&A0.overlays)||A0.manual){if(a){if(!Bb&&!AF&&!Au&&!V&&A0.currentIndex+2<=A0.pageTotal-2){AP.stop().animate(An.hover.p2,An.hover.speed,A0.easing);Bf.addClass("b-grab");if(A0.closed&&A0.autoCenter&&A0.currentIndex==0){Bf.stop().animate(An.hover.p3closed,An.hover.speed,A0.easing)}else{Bf.stop().animate(An.hover.p3,An.hover.speed,A0.easing)}Bd.stop().animate(An.hover.p3wrap,An.hover.speed,A0.easing);if(A0.shadows&&!B.support.opacity){A1.css({"right":"auto","left":"-40%"})}AF=true}}else{if(!Bb&&!Au&&!AF&&!v&&A0.currentIndex-2>=0){Az.stop().animate(An.hover.p1,An.hover.speed,A0.easing);y.addClass("b-grab");A9.stop().animate(An.hover.p1wrap,An.hover.speed,A0.easing);y.stop().animate(An.hover.p0,An.hover.speed,A0.easing);AY.stop().animate(An.hover.p0wrap,An.hover.speed,A0.easing);if(A0.shadows&&!B.support.opacity){Ax.css({"left":-0.38*AL})}Au=true}}}},A8=function(a){if((A0.hovers&&A0.overlays)||A0.manual){if(a){if(!Bb&&AF&&!V&&A0.currentIndex+2<=A0.pageTotal-2){if(A0.closed&&A0.autoCenter&&A0.currentIndex==0){AP.stop().animate(An.hover.p2closedEnd,An.hover.speed,A0.easing);Bf.stop().animate(An.hover.p3closedEnd,An.hover.speed,A0.easing)}else{AP.stop().animate(An.hover.p2end,An.hover.speed,A0.easing);Bf.stop().animate(An.hover.p3end,An.hover.speed,A0.easing)}Bd.stop().animate(An.hover.p3wrapEnd,An.hover.speed,A0.easing);if(A0.shadows&&!B.support.opacity){A1.css({"left":"auto"})}AF=false}}else{if(!Bb&&Au&&!v&&A0.currentIndex-2>=0){Az.stop().animate(An.hover.p1end,An.hover.speed,A0.easing);A9.stop().animate(An.hover.p1wrapEnd,An.hover.speed,A0.easing);y.stop().animate(An.hover.p0end,An.hover.speed,A0.easing);AY.stop().animate(An.hover.p0wrapEnd,An.hover.speed,A0.easing);Au=false}}}},Ar=function(i,a,j,h){if(a&&i>2){AT.find(".b-p3, .b-p4").removeClass("b-p3 b-p4").hide();AT.find(".b-page-"+A0.currentIndex).addClass("b-p3").show().stop().css(x.p3);AT.find(".b-page-"+(A0.currentIndex+1)).addClass("b-p4").show().css(x.p4);AT.find(".b-page-"+A0.currentIndex+" .b-wrap").show().css(x.wrap);AT.find(".b-page-"+(A0.currentIndex+1)+" .b-wrap").show().css(x.wrap);Bf=AT.find(".b-p3");Y=AT.find(".b-p4");Bd=AT.find(".b-p3 .b-wrap");Aq=AT.find(".b-p4 .b-wrap");if(A0.closed&&A0.autoCenter&&A0.currentIndex-i==0){Bf.css({"left":AL});Y.css({"left":0})}if(AF){Bf.css({"left":A0.width-40,"width":20,"padding-left":10})}if(A0.shadows){AT.find(".b-shadow-f").remove();A1=B(X.sF).css(x.sF).appendTo(Bf);j=A1}}else{if(!a&&i>2){AT.find(".b-pN, .b-p0").removeClass("b-pN b-p0").hide();AT.find(".b-page-"+A0.currentIndex).addClass("b-pN").show().css(x.pN);AT.find(".b-page-"+(A0.currentIndex+1)).addClass("b-p0").show().css(x.p0);AT.find(".b-page-"+A0.currentIndex+" .b-wrap").show().css(x.wrap);AT.find(".b-page-"+(A0.currentIndex+1)+" .b-wrap").show().css(x.wrap);Z=AT.find(".b-pN");y=AT.find(".b-p0");S=AT.find(".b-pN .b-wrap");AY=AT.find(".b-p0 .b-wrap");if(A0.closed&&A0.autoCenter){Z.css({"left":0})}AY.css(x.p0wrap);if(Au){y.css({left:10,width:40});AY.css({right:10})}if(A0.shadows){AT.find(".b-shadow-b, .b-shadow-f").remove();Ax=B(X.sB).appendTo(y).css(x.sB);j=Ax}}}if(A0.closed){if(!a&&A0.currentIndex==0){Z.hide()}else{if(!a){Z.show()}}if(a&&A0.currentIndex>=A0.pageTotal-2){Y.hide()}else{if(a){Y.show()}}}if(A0.shadows){if(B.support.opacity){if(!V&&!v){j.animate({opacity:1},h,A0.easeIn)}j.animate({opacity:0},h,A0.easeOut)}else{if(a){j.animate({right:A0.shadowTopFwdWidth},h*2,A0.easeIn)}else{j.animate({left:A0.shadowTopBackWidth},h*2,A0.easeIn)}}}if(A0.closed&&A0.autoCenter){if(A0.currentIndex==0){Bf.hide();Y.hide();AT.animate({width:AL},!V&&!v?h*2:h,A0.easing)}else{if(A0.currentIndex>=A0.pageTotal-2){y.hide();Z.hide();AT.animate({width:AL},h*2,A0.easing)}else{AT.animate({width:A0.width},h*2,A0.easing)}}}},I=function(){Ao();Bg();A3();Bb=false;Ay={options:jQuery.extend({},A0),index:A0.currentIndex,pages:[E[A0.currentIndex].contentNode,E[A0.currentIndex+1].contentNode]};if(A0.change){AT.off(Ac.change+".booklet").on(Ac.change+".booklet",A0.change)}AT.trigger(Ac.change,Ay)};return{init:A6,enable:AZ,disable:Ah,destroy:m,next:AE,prev:Bc,gotopage:function(a){if(typeof a==="string"){if(a=="start"){a=0}else{if(a=="end"){a=A0.pageTotal-2}else{this.gotopage(parseInt(a))}}}else{if(typeof a==="number"){if(a<0||a>=A0.pageTotal){return}}else{if(typeof a==="undefined"){return}}}if(a%2!=0){a-=1}if(A0.direction==AD.rightToLeft){a=Math.abs(a-A0.pageTotal)-2}t(a)},add:A2,remove:q,option:function(a,h){if(typeof a==="string"){if(A0[a]){if(typeof h!=="undefined"){A0[a]=h;b()}else{return A0[a]}}else{B.error('Option "'+a+'" does not exist on jQuery.booklet.')}}else{if(typeof a==="object"){b(a)}else{if(typeof a==="undefined"||!a){return jQuery.extend({},A0)}}}}}}B.fn.booklet.defaults={name:null,width:600,height:400,speed:1000,direction:"LTR",startingPage:0,easing:"easeInOutQuad",easeIn:"easeInQuad",easeOut:"easeOutQuad",closed:false,closedFrontTitle:"Beginning",closedFrontChapter:"Beginning of Book",closedBackTitle:"End",closedBackChapter:"End of Book",covers:false,autoCenter:false,pagePadding:10,pageNumbers:true,pageBorder:0,manual:true,hovers:true,hoverWidth:50,hoverSpeed:500,hoverThreshold:0.25,hoverClick:true,overlays:false,tabs:false,tabWidth:60,tabHeight:20,nextControlText:"Next",previousControlText:"Previous",nextControlTitle:"Next Page",previousControlTitle:"Previous Page",arrows:false,arrowsHide:false,cursor:"pointer",hash:false,hashTitleText:" - Page ",keyboard:true,next:null,prev:null,auto:false,delay:5000,pause:null,play:null,menu:null,pageSelector:false,chapterSelector:false,shadows:true,shadowTopFwdWidth:166,shadowTopBackWidth:166,shadowBtmWidth:50,create:null,start:null,change:null,add:null,remove:null}})(jQuery);